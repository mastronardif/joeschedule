<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252"/>
<title>Calander</title>
<link rel="stylesheet" type="text/css" href="/cgi/ngfop/sch01.css"/>
<link rel="stylesheet" type="text/css" href="/cgi/ngfop/sch1.css"/>
</head>

<script type="text/javascript">
<!-- Original:  Nick Korosi (nfk2000@hotmail.com) -->
<!-- This script and many more are available free online at -->
<!-- The JavaScript Source!! http://javascript.internet.com -->

<!-- Begin


/**********************************************/
// FM's shit

function EditCalUsers()
{
	var str = "/cgi-bin/cgi/ngfop/other2.pl?htmlname=editcalusersframe.htm&name="+"EditCalUsers.xml";
//	var str = "/cgi-bin/cgi/ngfop/other2.pl?htmlname=editschframe.htm&name=EditCalUsers.xml";


	top.frames[3].location=str;
 //   <a class="menuitem" title="Edit" href="javascript:alert('EditCalUsers');" >Edit</a>

}

var GGGmyElement = 0;
function disable()
{
//	alert("calander clearAllRadioButtons()");

	if (GGGmyElement)
		RSetSelectedDay(GGGmyElement);
}

function RSetSelectedDay(myElement)
{
   if (myElement.id == "calCell") {
//FM 1/14/04      if (!isNaN(parseInt(myElement.children["calDateText"].innerText))) {
      if (!isNaN(parseInt(myElement.children["calDateText"].innerText))) {
         myElement.bgColor = "#c0c0c0";
         objPrevElement.bgColor = "";
         document.all.calSelectedDate.value = parseInt(myElement.children["calDateText"].innerText);
         objPrevElement = myElement;
      }
   }
   else	if (myElement.id == "calDay") 
	{
         myElement.bgColor = "#c0c0c0";

         objPrevElement.bgColor = "";
         //document.all.calSelectedDate.value = parseInt(myElement.children["calDateText"].innerText);
         
		 document.all.calSelectedDate.value = myElement.children["calDay"].innerText;
         
		 objPrevElement = myElement;
	} 
}



function notifytop(val)
{
	// I'm [0]
	parent.frames[1].disable();
	parent.frames[2].disable();

	top.frames[0].setLeftValue("calander", val);
/****
	if (myform.ck1.checked)
	{
		ShowDate(document.myform.date.options[document.myform.date.selectedIndex].text);
	}
********/

}

function ShowDate(szSrc)
{
top.frames[0].ShowDate(szSrc);
//alert(szSrc);
//var xmlfilename="blank.xml";
//var str = '/cgi-bin/cgi/ngfop/sch3b.pl?htmlname=sch3b.htm&name='+xmlfilename;
//parent.middle.location=str;
// top.frames[2].location=str;
//top.frames[0].editSchedule2()

//top.frames[0].ShowDate(szSrc);

//  <input type="radio" value="V1" checked name="C1"> <A HREF="/cgi-bin/cgi/ngfop/sch3.pl?name=%s" TARGET="middle">%s</A>
}

/**********************************************/



var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;
var isOpera5=(navigator.appVersion.indexOf("MSIE 5")!=-1 && navigator.userAgent.indexOf("Opera 5")!=-1)?true:false;
var isOpera6=(navigator.appVersion.indexOf("MSIE 5")!=-1 && navigator.userAgent.indexOf("Opera 6")!=-1)?true:false;
var isN6=(navigator.userAgent.indexOf("Gecko")!=-1);
var isN6=(navigator.userAgent.indexOf("Gecko")!=-1);
var isN4=(document.layers)?true:false;
var isMac=(navigator.userAgent.indexOf("Mac")!=-1);
var isIE=(document.all && !isOpera && (!isMac || navigator.appVersion.indexOf("MSIE 4")==-1))?true:false;


var dDate = new Date();
var dCurMonth = dDate.getMonth();
var dCurDayOfMonth = dDate.getDate();
var dCurYear = dDate.getFullYear();
var objPrevElement = new Object();



function getData() 
{
	var dDate = new Date(myform.tbSelYear.value, 
                     parseInt(myform.tbSelMonth.value)-1, 
                     parseInt(document.all.calSelectedDate.value));

	var yyyy_mm_dd=	myform.tbSelYear.value+"_"+
					myform.tbSelMonth.value+"_"+
					document.all.calSelectedDate.value;

//	alert("yyyy_mm_dd("+yyyy_mm_dd+")");
//	alert("document.all.calSelectedDate.value("+document.all.calSelectedDate.value+")");

    if (isNaN(parseInt(document.all.calSelectedDate.value)) )
	{
		//alert("is this a day: "+document.all.calSelectedDate.value);
		return document.all.calSelectedDate.value;
	}
	else
		return yyyy_mm_dd;
		//alert(yyyy_mm_dd);

//	return dDate;
}

function fToggleColor(myElement) 
{
	var toggleColor = "#ff0000";
	if (myElement.id == "calDateText") 
	{
		if (myElement.color == toggleColor) 
		{
			myElement.color = "";
		} 
		else 
		{
			myElement.color = toggleColor;
		}
	} 
	else if (myElement.id == "calCell") 
	{
		for (var i in myElement.children) 
		{
			if (myElement.children[i].id == "calDateText") 
			{
				if (myElement.children[i].color == toggleColor) 
				{
					myElement.children[i].color = "";
				} 
				else 
				{
					myElement.children[i].color = toggleColor;
				}
			}
		}
   }
   else	if (myElement.id == "calDay") 
	{
		if (myElement.color == toggleColor) 
		{
			myElement.color = "";
		} 
		else 
		{
			myElement.color = toggleColor;
		}
	} 




}

function fSetSelectedDay(myElement)
{
//alert(myElement.id);
GGGmyElement = myElement;
//alert("fSetSelectedDay(myElement)");

   if (myElement.id == "calCell") 
   {
      if (!isNaN(parseInt(myElement.children["calDateText"].innerText))) 
	  {
         myElement.bgColor = "#c0c0c0";

         // FM 4/15/04 
		 if(myElement!=objPrevElement)
			objPrevElement.bgColor = "";
         // FM 4/15/04 

         //objPrevElement.bgColor = "red";
         // FM 4/15/04 objPrevElement.bgColor = "";
         document.all.calSelectedDate.value = parseInt(myElement.children["calDateText"].innerText);
         objPrevElement = myElement;
      }
   }
   else	if (myElement.id == "calDay") 
   {
         myElement.bgColor = "#c0c0c0";

         // FM 4/15/04 
		 if(myElement!=objPrevElement)
			objPrevElement.bgColor = "";
         // FM 4/15/04 

         //objPrevElement.bgColor = "red";
         // FM 4/15/04 objPrevElement.bgColor = "";
         //document.all.calSelectedDate.value = parseInt(myElement.children["calDateText"].innerText);
		 
		 if (myElement.children["calDay"])
		 {
			//alert(myElement.children["calDay"].innerText);
			document.all.calSelectedDate.value = myElement.children["calDay"].innerText;
		 }

         //document.all.calSelectedDate.value = parseInt(myElement.children["calDay"].innerText);


         objPrevElement = myElement;
   }



// FM 1/4/034
var date = getData();

//alert("in calander.htm, FU whats the date?____________"+date);
notifytop(date);
// FM 1/4/034

}

function fGetDaysInMonth(iMonth, iYear) {
	var dPrevDate = new Date(iYear, iMonth, 0);
	return dPrevDate.getDate();
}

function fBuildCal(iYear, iMonth, iDayStyle) {
var aMonth = new Array();
aMonth[0] = new Array(7);
aMonth[1] = new Array(7);
aMonth[2] = new Array(7);
aMonth[3] = new Array(7);
aMonth[4] = new Array(7);
aMonth[5] = new Array(7);
aMonth[6] = new Array(7);
var dCalDate = new Date(iYear, iMonth-1, 1);
var iDayOfFirst = dCalDate.getDay();
var iDaysInMonth = fGetDaysInMonth(iMonth, iYear);
var iVarDate = 1;
var i, d, w;
if (iDayStyle == 2) {
aMonth[0][0] = "Sunday";
aMonth[0][1] = "Monday";
aMonth[0][2] = "Tuesday";
aMonth[0][3] = "Wednesday";
aMonth[0][4] = "Thursday";
aMonth[0][5] = "Friday";
aMonth[0][6] = "Saturday";
} else if (iDayStyle == 1) {
aMonth[0][0] = "Sun";
aMonth[0][1] = "Mon";
aMonth[0][2] = "Tue";
aMonth[0][3] = "Wed";
aMonth[0][4] = "Thu";
aMonth[0][5] = "Fri";
aMonth[0][6] = "Sat";
} else {
aMonth[0][0] = "Su";
aMonth[0][1] = "Mo";
aMonth[0][2] = "Tu";
aMonth[0][3] = "We";
aMonth[0][4] = "Th";
aMonth[0][5] = "Fr";
aMonth[0][6] = "Sa";
}

for (d = iDayOfFirst; d < 7; d++) {
	aMonth[1][d] = iVarDate;
	iVarDate++;
}

for (w = 2; w < 7; w++) {
	for (d = 0; d < 7; d++) {
		if (iVarDate <= iDaysInMonth) {
			aMonth[w][d] = iVarDate;
			iVarDate++;
		}
   }
}

return aMonth;
}

function fDrawCal(iYear, iMonth, iCellWidth, iCellHeight, sDateTextSize, sDateTextWeight, iDayStyle) 
{
myform.tbSelMonth.options[dCurDate.getMonth()].selected = true;
//alert(iMonth);

var myMonth;
myMonth = fBuildCal(iYear, iMonth, iDayStyle);
document.write("<table border='1'>")
document.write("<tr>");

	 <!-- Sun -->
     document.write("<td align='center' id=calDay style='CURSOR:Hand' "+
					"onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' "+
					"onclick=fSetSelectedDay(this)>");
     document.write("<font id=calDay onMouseOver='fToggleColor(this)'"+ 
	 "style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold'" + 
	 "onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>" + myMonth[0][0]+"</font>");
     document.write("</td>");


for (var iday=1; iday<7; iday++)
{
     document.write("<td align='center' id=calDay style='CURSOR:Hand' "+
					"onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' "+
					"onclick=fSetSelectedDay(this)>");
     document.write("<font id=calDay onMouseOver='fToggleColor(this)'"+ 
	 "style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold'" + 
	 "onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>" + myMonth[0][iday]+"</font>");
     document.write("</td>");
}

/****
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][0] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][1] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][2] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][3] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][4] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][5] + "</td>");
document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>" + myMonth[0][6] + "</td>");
****/
document.write("</tr>");

for (w = 1; w < 7; w++) {
  document.write("<tr>")
  for (d = 0; d < 7; d++) {

     document.write("<td align='left' valign='top' width='" + iCellWidth + "' height='" + iCellHeight + "' id=calCell style='CURSOR:Hand' onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>");
//FM 1/14/04     if (!isNaN(myMonth[w][d])) {
     if (!isNaN(myMonth[w][d])) {
        document.write("<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:" + sDateTextSize + ";FONT-WEIGHT:" + sDateTextWeight + "' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>" + myMonth[w][d] + "</font>");
     } else {
        document.write("<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:" + sDateTextSize + ";FONT-WEIGHT:" + sDateTextWeight + "' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)> </font>");
     }
     document.write("</td>")
  }

  document.write("</tr>");

}

  document.write("</table>")
}

function fUpdateCal(iYear, iMonth) 
{
	myMonth = fBuildCal(iYear, iMonth);
	objPrevElement.bgColor = "";
	document.all.calSelectedDate.value = "";
	for (w = 1; w < 7; w++) 
	{
		for (d = 0; d < 7; d++) {
			if (!isNaN(myMonth[w][d])) {
				calDateText[((7*w)+d)-7].innerText = myMonth[w][d];
			} 
			else 
			{
				calDateText[((7*w)+d)-7].innerText = " ";
			}
		}
	}
}
// End -->
</script>


<body class="toolbar" topmargin="0" leftmargin="0">

<!--
<body topmargin="0" leftmargin="0">
<body class="toolbar" topmargin="0" leftmargin="0">
<body bgcolor="#FFFFFF" background="/cgi/ngfop/bg1.gif"
text="#000080" link="#800000" vlink="#008080">
-->


<SCRIPT LANGUAGE="JavaScript" for=window event=onload>
<!-- begin
var dCurDate = new Date();
myform.tbSelMonth.options[dCurDate.getMonth()].selected = true;
//alert(dCurDate.getMonth())
//myform.tbSelMonth.options[2].selected = true;

for (i = 0; i < myform.tbSelYear.length; i++)
if (myform.tbSelYear.options[i].value == dCurDate.getFullYear())
myform.tbSelYear.options[i].selected = true;
// End -->
</script>

<form name="myform" method="post" action="">

<input type="hidden" name="name" value="calander.htm">
<input type="hidden" name="calSelectedDate" value="">

<table border="0">
<tr>
<td>

<!-- Calander related stuff -->
<!--
<SELECT NAME="People" 
	style="color: navy; background: #C9E8FB; font-family: Verdana; font-size:12;">
<CALANDER_USERS>
	<OPTION VALUE="1"><NAME>
</CALANDER_USERS>
</SELECT>

<SELECT NAME="date" 
	style="color: navy; background: #C9E8FB; font-family: Verdana; font-size:12;">
	<OPTION VALUE="-1">Day
	<OPTION VALUE="1">Week
</SELECT>

		<a class="menuitem" onClick="ShowDate(document.myform.date.options[document.myform.date.selectedIndex].text);"
		title="Show Day or Week" href="#dummy">Go! </a> 
<input type="checkbox" name="ck1">
-->
<!-- Calander related stuff -->



<select name="tbSelMonth" 
  style="color: black;
	background:#3DB3DD; font-family: Verdana; font-size: 50%; font-weight:
	bold"
onchange='fUpdateCal(myform.tbSelYear.value, myform.tbSelMonth.value)'>
<option value="1">January</option>
<option value="2">February</option>
<option value="3">March</option>
<option value="4">April</option>
<option value="5">May</option>
<option value="6">June</option>
<option value="7">July</option>
<option value="8">August</option>
<option value="9">September</option>
<option value="10">October</option>
<option value="11">November</option>
<option value="12">December</option>
</select>

<select name="tbSelYear" 
  style="color: black;
	background:#3DB3DD; font-family: Verdana; font-size: 50%; font-weight:
	bold"
onchange='fUpdateCal(myform.tbSelYear.value, myform.tbSelMonth.value)'>
<option value="2004">2004</option>
<option value="2005">2005</option>
<option value="2006">2006</option>
</select>
    <a class="menuitem" title="Edit Calander Users" href="javascript:EditCalUsers();" >Users</a>

</td>

</tr>
<tr>
<td>

<script language="JavaScript">
var dCurDate = new Date();
//function fDrawCal(iYear, iMonth, iCellWidth, iCellHeight, sDateTextSize, sDateTextWeight, iDayStyle) 
//fDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 30, 30, "12px", "bold", 1);
//fDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 20, 20, "12px", "bold", 0);
//fDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 15, 15, "12px", "bold", 0);

fDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 15, 15, "12px", "bold", 1);
</script>
</td>
</tr>
</table>
</form>
<!-- Script Size:  7.06 KB -->
</body>

</html>
